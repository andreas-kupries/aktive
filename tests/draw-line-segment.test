# -*- tcl -*- tcl.tk//DSL tcltest//EN//2.0 tcl.tk//DSL tcltest//EN//2.0
## (c) 2024 Andreas Kupries
# # ## ### ##### ######## ############# #####################
## AKTIVE. Drawing line segments

kt check Tcl     8.6 9
kt check tcltest 2

# # ## ### ##### ######## ############# #####################

kt local testing aktive

kt source support/util.tcl

# # ## ### ##### ######## ############# #####################
## Syntax

syntax {
    line      args
    poly-line args
} {aktive image draw}

# # ## ### ##### ######## ############# #####################

foreach {id config expected} {
    0 {antialias 0 strokewidth 0} {
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ 1 1 1 _ _ _ _
	 _ 1 1 1 _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
    }
    2 {antialias 0 strokewidth 1} {
 	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ 1 1 1 1 _ _ _
	 1 1 1 1 1 1 1 1 _ _ _
	 1 1 1 1 1 1 1 1 _ _ _
	 1 1 1 1 _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
   }
    3 {antialias 1 strokewidth 0} {
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      0.1272 0.3233 0.5000 0.0858 _      _      _
	 0.0858 0.5194 0.7155 0.9117 1      1      1      0.5000 _      _      _
	 0.5000 1      1      1      0.9117 0.7155 0.5194 0.0858 _      _      _
	 0.0858 0.5000 0.3233 0.1272 _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
    }
    4 {antialias 1 strokewidth 1} {
	 _      _      _      _      0.1466 0.3427 0.5000 0.2639 _      _      _
	 0.2639 0.5388 0.7350 0.9311 1      1      1      1      0.2639 _      _
	 1      1      1      1      1      1      1      1      0.5000 _      _
	 1      1      1      1      1      1      1      1      0.2639 _      _
	 1      1      1      1      0.9311 0.7350 0.5388 0.2639 _      _      _
	 0.2639 0.5000 0.3427 0.1466 _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
    }
} {
    test aktive-image-draw-line-2.${id}-[join $config -] "aktive image draw line, $config" -body {
	astcl aktive image draw line width 11 height 11 from {1 3} to {6 2} {*}$config
    } -match image -result [makei image::draw::line 0 0 11 11 1 \
				"width 11 height 11 x 0 y 0 $config from {1 3} to {6 2}" \
				[bw $expected]]
}

foreach {id config expected} {
    0 {antialias 0 strokewidth 0} {
	 _ _ _ 1 1 _ _ _ _ _ _
	 _ _ 1 _ _ _ _ _ _ _ _
	 _ 1 _ _ _ _ _ _ _ _ _
	 1 _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
    }
    2 {antialias 0 strokewidth 1} {
	 _ 1 1 1 1 1 _ _ _ _ _
	 1 1 1 1 1 _ _ _ _ _ _
	 1 1 1 1 _ _ _ _ _ _ _
	 1 1 1 _ _ _ _ _ _ _ _
	 1 _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
	 _ _ _ _ _ _ _ _ _ _ _
    }
    3 {antialias 1 strokewidth 0} {
	 _      0.0090 0.6229 1      1      0.5352 _      _      _      _      _
	 0.1844 0.7984 1      0.9738 0.3598 _      _      _      _      _      _
	 0.9738 1      0.7984 0.1844 _      _      _      _      _      _      _
	 1      0.6229 0.0090 _      _      _      _      _      _      _      _
	 0.4475 _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
    }
    4 {antialias 1 strokewidth 1} {
	 0.3951 1      1      1      1      1      0.9213 0.3074 _      _      _
	 1      1      1      1      1      0.7459 0.1319 _      _      _      _
	 1      1      1      1      0.5705 _      _      _      _      _      _
	 1      1      1      0.3951 _      _      _      _      _      _      _
	 1      0.8336 0.2196 _      _      _      _      _      _      _      _
	 0.6582 0.0442 _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
	 _      _      _      _      _      _      _      _      _      _      _
    }
} {
    test aktive-image-draw-line-3.${id}-[join $config -] "aktive image draw line, $config, crossing" -body {
	astcl aktive image draw line width 11 height 11 from {-3 5} to {6 -2} {*}$config
    } -match image -result [makei image::draw::line 0 0 11 11 1 \
				"width 11 height 11 x 0 y 0 $config from {-3 5} to {6 -2}" \
				[bw $expected]]
}

# # ## ### ##### ######## ############# #####################

foreach {id config expected} {
    0 {antialias 0 strokewidth 0} {
	_ _ _ _ _ _ _ _ _ _ _ _ _
	_ _ _ _ _ _ _ _ _ _ _ _ _
	_ _ 1 1 1 1 1 1 1 1 1 _ _
	_ _ _ _ _ _ _ _ _ _ 1 _ _
	_ _ _ _ _ _ _ _ _ _ 1 _ _
	_ _ _ _ _ _ _ _ _ _ 1 _ _
	_ _ 1 1 1 1 1 1 _ _ 1 _ _
	_ _ 1 _ _ _ _ _ _ _ 1 _ _
	_ _ 1 _ _ _ _ _ _ _ 1 _ _
	_ _ 1 _ _ _ _ _ _ _ 1 _ _
	_ _ 1 1 1 1 1 1 1 1 1 _ _
	_ _ _ _ _ _ _ _ _ _ _ _ _
	_ _ _ _ _ _ _ _ _ _ _ _ _
    }
    2 {antialias 0 strokewidth 1} {
	_ _ _ _ _ _ _ _ _ _ _ _ _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ _ _ _ _ _ _ _ _ 1 1 1 _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ 1 1 1 _ _ _ _ _ 1 1 1 _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ 1 1 1 1 1 1 1 1 1 1 1 _
	_ _ _ _ _ _ _ _ _ _ _ _ _
    }
    3 {antialias 1 strokewidth 0} {
	 _      _      _      _      _      _      _      _      _      _      _      _      _
         _      0.0858 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.0858 _
         _      0.5000 1      1      1      1      1      1      1      1      1      0.5000 _
         _      0.0858 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 1      0.5000 _
         _      _      _      _      _      _      _      _      _      0.5000 1      0.5000 _
         _      0.0858 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.0858 0.5000 1      0.5000 _
         _      0.5000 1      1      1      1      1      1      0.5000 0.5000 1      0.5000 _
         _      0.5000 1      0.5000 0.5000 0.5000 0.5000 0.5000 0.0858 0.5000 1      0.5000 _
         _      0.5000 1      0.5000 _      _      _      _      _      0.5000 1      0.5000 _
         _      0.5000 1      0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 1      0.5000 _
         _      0.5000 1      1      1      1      1      1      1      1      1      0.5000 _
         _      0.0858 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.0858 _
         _      _      _      _      _      _      _      _      _      _      _      _      _

    }
    4 {antialias 1 strokewidth 1} {
	 _      0.2639 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.2639 _
         0.2639 1      1      1      1      1      1      1      1      1      1      1      0.2639
         0.5000 1      1      1      1      1      1      1      1      1      1      1      0.5000
         0.2639 1      1      1      1      1      1      1      1      1      1      1      0.5000
         _      0.2639 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 1      1      1      0.5000
         0.2639 1      1      1      1      1      1      1      1      1      1      1      0.5000
         0.5000 1      1      1      1      1      1      1      1      1      1      1      0.5000
         0.5000 1      1      1      1      1      1      1      1      1      1      1      0.5000
         0.5000 1      1      1      0.5000 0.5000 0.5000 0.5000 0.5000 1      1      1      0.5000
         0.5000 1      1      1      1      1      1      1      1      1      1      1      0.5000
         0.5000 1      1      1      1      1      1      1      1      1      1      1      0.5000
         0.2639 1      1      1      1      1      1      1      1      1      1      1      0.2639
         _      0.2639 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.2639 _
    }
} {
    test aktive-image-draw-poly-line-2.${id}-[join $config -] "aktive image draw line, $config, crossing" -body {
	astcl aktive image draw poly-line width 13 height 13 {*}$config points \
	    {2 2} {10 2} {10 10} {2 10} {2 6} {7 6}
	#   A     B      C       D      E     F
	##
	# _ _ _ _ _ _ _ _ _ _ _ _ _ 0
	# _ _ _ _ _ _ _ _ _ _ _ _ _ 1
	# _ _ A _ _ _ _ _ _ _ B _ _ 2
	# _ _ _ _ _ _ _ _ _ _ _ _ _ 3
	# _ _ _ _ _ _ _ _ _ _ _ _ _ 4
	# _ _ _ _ _ _ _ _ _ _ _ _ _ 5
	# _ _ E _ _ _ _ F _ _ _ _ _ 6
	# _ _ _ _ _ _ _ _ _ _ _ _ _ 7
	# _ _ _ _ _ _ _ _ _ _ _ _ _ 8
	# _ _ _ _ _ _ _ _ _ _ _ _ _ 9
	# _ _ D _ _ _ _ _ _ _ C _ _ a /10
	# _ _ _ _ _ _ _ _ _ _ _ _ _ b /11
	# _ _ _ _ _ _ _ _ _ _ _ _ _ c /12
	# 0 1 2 3 4 5 6 7 8 9 a b c
    } -match image -result [makei op::math::max-core 0 0 13 13 1 {} [bw $expected]]
}

# # ## ### ##### ######## ############# #####################
unset id config expected
cleanupTests
return
